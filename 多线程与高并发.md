# 多线程与高并发

##### 1.线程与进程

进程是一个实体。`每一个进程都有它自己的地址空间`，一般情况下，包括`文本区域`（text region）、`数据区域`

（data region）和`堆栈`（stack region）。

- 文本区域存储处理器执行的代码;
- 数据区域存储变量和进程执行;期间使用的动态分配的内存;
- 堆栈区域存储着活动过程调用的指令和本地变量

一个标准的线程由`线程ID`，`当前指令指针(PC`），`寄存器集合`和`堆栈`组成。另外，线程是进程中的一个实体，是被

系统独立调度和分派的基本单位，线程自己不拥有系统资源，只拥有一点儿在运行中必不可少的资源，但它可与同

属一个进程的其它线程共享进程所拥有的全部资源。

`区别不同`

- 地址空间:进程内的一个执行单元;进程至少有一个线程;它们共享进程的地址空间;而进 程有自己独立的地址空间
- 资源拥有:进程是资源分配和拥有的单位,同一个进程内的线程共享进程的资 
- 线程是处理器调度的基本单位,但进程不是
- 二者均可并发执行

##### 2.守护线程

在 Java 中有两类线程：用户线程 (User Thread)、守护线程 (Daemon Thread)。 守护线程和用户线程的区别在于：守护线程依赖于创建它的线程，而用户线程则不依赖。举 个简单的例子：如果在 main 线程中创建了一个守护线程，当 main 方法运行完毕之后，守 护线程也会随着消亡。而用户线程则不会，用户线程会一直运行直到其运行完毕。在 JVM 中，像垃圾收集器线程就是守护线程。

##### 3.java的线程状态

官方文档定义的线程状态：

- 线程状态。线程可以处于以下状态之一：

  - [`NEW`](../../java/lang/Thread.State.html#NEW)  
    尚未启动的线程处于此状态。 
  - [`RUNNABLE`](../../java/lang/Thread.State.html#RUNNABLE)  
    在Java虚拟机中执行的线程处于此状态。 
  - [`BLOCKED`](../../java/lang/Thread.State.html#BLOCKED)  
    被阻塞等待监视器锁定的线程处于此状态。 
  - [`WAITING`](../../java/lang/Thread.State.html#WAITING)  
    正在等待另一个线程执行特定动作的线程处于此状态。 
  - [`TIMED_WAITING`](../../java/lang/Thread.State.html#TIMED_WAITING)  
    正在等待另一个线程执行动作达到指定等待时间的线程处于此状态。 
  - [`TERMINATED`](../../java/lang/Thread.State.html#TERMINATED)  
    已退出的线程处于此状态。 

  一个线程可以在给定时间点处于一个状态。 这些状态是不反映任何操作系统线程状态的虚拟机状态。 

![](C:\Users\Administrator\Desktop\图片示例\线程状态.png)



##### 4.线程同步以及线程调度的相关方法

- wait()：使一个线程处于等待（阻塞）状态，并且释放所持有的对象的锁；
- sleep()：使一个正在运行的线程处于睡眠状态，是一个静态方法，调用此方法要处理InterruptedException 异常； 
- notify()：唤醒一个处于等待状态的线程，当然在调用此方法的时候，并不能确切的唤醒某一个等待状态的线程，而是由 JVM 确定唤醒哪个线程，而且与优先级无关；
- notityAll()：唤醒所有处于等待状态的线程，该方法并不是将对象的锁给所有线程，而是 让它们竞争，只有获得锁的线程才能进入就绪状态； 

##### 5.进程调度的相关算法

`实时系统`

- FIFO(First Input First Output，先进先出算法)
- SJF(Shortest Job First， 最短作业优先算法)
- SRTF(Shortest Remaining Time First，最短剩余时间优先算法）

`交互式系统`

- RR(Round Robin，时间片轮转算法)
- HPF(Highest Priority First，最高优先级算法)
- 多级队列
- 最短进程优先
- 保证调度
- 彩票调度
- 公平分享调度

6.wait()和sleep()的区别

- sleep来自Thread类，wait来自Object类
- `调用sleep方法线程不会释放对象锁`,但是`调用wait方法线程会释放对象的锁`
- sleep 睡眠后不出让系统资源，wait 让出系统资源其他线程可以占用 CPU
- sleep(milliseconds)需要指定一个睡眠时间，时间一到会自动唤醒 

